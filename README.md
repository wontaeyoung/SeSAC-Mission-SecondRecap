# 에러 케이스 파악의 어려움

이미 Utility에 구현해놓은 AFManager나 HTTP Client를 사용했다.

에러 메세지 로깅과 사용자 Alert 문구를 일괄적으로 관리하기 위해 AppError 프로토콜을 채택한 에러 케이스들을 정의하고, 네트워크 요청의 각 에러 상황에 대해 미리 정의한 AppError 케이스들을 throw 하도록 구현했다.

그래서 모든 API 콜에서 발생할 수 있는 공통적인 상황 (URL 문제, Json 디코딩, 상태코드 200번대 X)은 확인할 수 있었지만, API마다 커스텀하게 발생하는 에러에 대해 확인이 불가했다.

특히 이번 Coin API에서는 Call 횟수가 극단적으로 제한되어 있었는데, 미리 정의된 Error 케이스에 해당하지 않으니 공통적인 에러 메세지로 빠지게 되어서, 에러가 발생했을 때 Call수 제한인건지 다른 에러가 발생한건지 확인이 어려웠다.

처음에는 Alamofire를 사용하고 있었는데, 우선은 로직을 커스텀하게 구현하기 위해서 URLSession을 사용하는 HTTP Client로 교체하고, callRequest 메서드에서 추가적으로 정의한 HTTP Status Code를 받아서 에러 메세지로 확인할 수 있는 구조로 변경했다.

AppError 프로토콜로 에러를 관리하면서 일관적인 형태로 에러를 핸들링할 수 있는 장점은 있었지만, API에서 던져주는 에러를 확인할 수 있는 구조로 개선이 필요할 것 같다.
